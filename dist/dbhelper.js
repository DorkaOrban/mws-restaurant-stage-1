var database_version=10;class DBHelper{static get DATABASE_URL(){return`http://localhost:${1337}/restaurants`}static get DATABASE_NAME(){return'restaurant-db'}static get DATABASE_VERSION(){return database_version}static setVersion(a){return this.database_version=a,this.database_version}static fetchRestaurants(a){(async()=>{await fetch(DBHelper.DATABASE_URL).then(d=>{d.ok?d.json().then(e=>{const f=e;idb.open(DBHelper.DATABASE_NAME,DBHelper.DATABASE_VERSION,g=>{console.log('db old '+g.oldVersion);let h=g.createObjectStore('resKeyval');for(let j in f)h.put(f[j],j)}).catch(()=>{console.log('Failed')}),a(null,f)}):console.log(`Request failed. Returned status of ${d.status} with ${d.statusText}`)}).catch(()=>{DBHelper.setVersion(DBHelper.DATABASE_VERSION),idb.open(DBHelper.DATABASE_NAME,DBHelper.DATABASE_VERSION,e=>{switch(e.oldVersion){case 0:e.createObjectStore('resKeyval');case 1:}}).then(e=>{return e.transaction('resKeyval').objectStore('resKeyval').getAll()}).then(e=>a(null,e))})})()}static fetchRestaurantById(a,b){DBHelper.fetchRestaurants((c,d)=>{if(c)b(c,null);else{const e=d.find(f=>f.id==a);e?b(null,e):b('Restaurant does not exist',null)}})}static fetchRestaurantByCuisine(a,b){DBHelper.fetchRestaurants((c,d)=>{if(c)b(c,null);else{const e=d.filter(f=>f.cuisine_type==a);b(null,e)}})}static fetchRestaurantByNeighborhood(a,b){DBHelper.fetchRestaurants((c,d)=>{if(c)b(c,null);else{const e=d.filter(f=>f.neighborhood==a);b(null,e)}})}static fetchRestaurantByCuisineAndNeighborhood(a,b,c){DBHelper.fetchRestaurants((d,e)=>{if(d)c(d,null);else{let f=e;'all'!=a&&(f=f.filter(g=>g.cuisine_type==a)),'all'!=b&&(f=f.filter(g=>g.neighborhood==b)),c(null,f)}})}static fetchNeighborhoods(a){DBHelper.fetchRestaurants((b,c)=>{if(b)a(b,null);else{const d=c.map((f,g)=>c[g].neighborhood),e=d.filter((f,g)=>d.indexOf(f)==g);a(null,e)}})}static fetchCuisines(a){DBHelper.fetchRestaurants((b,c)=>{if(b)a(b,null);else{const d=c.map((f,g)=>c[g].cuisine_type),e=d.filter((f,g)=>d.indexOf(f)==g);a(null,e)}})}static urlForRestaurant(a){return`./restaurant.html?id=${a.id}`}static imageUrlForRestaurant(a){let b=a.photograph;return'undefined'==typeof b&&(b=a.id),`/img/${b}.jpg`}static mapMarkerForRestaurant(a,b){const c=new google.maps.Marker({position:a.latlng,title:a.name,url:DBHelper.urlForRestaurant(a),map:b,animation:google.maps.Animation.DROP});return c}}